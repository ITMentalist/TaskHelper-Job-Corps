Option Explicit

Sub EnrollmentAppButton_Click()

    u_JobCorps.Show

End Sub

Sub TransferCreditsButton_Click()

    u_TransferCredits.Show
    
End Sub

Sub LicenseInfo_Button_Click()

    ThisWorkbook.FollowHyperlink "http://www.gnu.org/licenses/gpl-3.0.en.html"
 
End Sub

Sub ShipmentsButton_Click()

    Dim SID As String: SID = vbNullString
    
    Dim ReturnValue As Integer: ReturnValue = 0
    
    Dim SendShipments As Boolean: SendShipments = False
    
    Dim Letter As String: Letter = vbNullString
    
    Dim Exception As cException: Set Exception = New cException
    Exception.Push "Procedure: ThisWorkbook.ShipmentsButton_Click"
    
    ReturnValue = MsgBox("*** Should shipments be sent for the following program? ***" & _
        vbNewLine & vbNewLine & vbNewLine & vbNewLine & _
        Space(3) & "Click 'Yes' to send the shipments." & vbNewLine & vbNewLine & _
        Space(3) & "Click 'No' to prevent the shipments." & vbNewLine & vbNewLine & _
        Space(3) & "Press 'Cancel' to end the application.", vbYesNoCancel, "Manage Shipments")
        
    Select Case ReturnValue
        Case vbYes
            SendShipments = True
        Case vbNo
            SendShipments = False
        Case vbCancel
            GoTo Cleanup
        Case Else
            GoTo Cleanup
    End Select
    
    SID = Application.InputBox("Enter the Student ID#")
    
    If SID = "" Then
        GoTo Cleanup
    ElseIf Len(SID) < 8 Or Len(SID) > 8 Or Not IsNumeric(SID) Then
        GoTo SIDFailure
    End If
    
    On Error GoTo AS400Error
    Letter = Application.InputBox("Enter the AS/400 Session")
    
    If Letter = "" Then
        GoTo Cleanup
    ElseIf Len(Letter) > 1 Then
        GoTo LetterLength
    End If

    Dim AS400 As cAS400
    Set AS400 = New cAS400

    InitializeAS400 AS400, Letter, Exception
    AS400.Handling = "Fast"
    AS400.Time = 50

    On Error Resume Next
    'ManageShipments AS400, SID, SendShipments, Exception

Cleanup:

    Exception.Pop

Exit Sub

SIDFailure:
    MsgBox "The Student ID must be a valid number", vbCritical, "Student ID"
GoTo Cleanup

LetterLength:
    MsgBox "The AS/400 Session must be a single letter", vbCritical, "AS/400 Session"
GoTo Cleanup

AS400Error:
    MsgBox "The AS400 has failed to initialize. Please confirm the session letter is correct " & _
        "and the AS/400 itself is active, then try again.", vbCritical, "AS400 Error"
Resume Cleanup


End Sub
